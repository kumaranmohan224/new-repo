package com.newdemo.test.EZTPart1;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.text.DecimalFormat;
import java.util.List;

import org.testng.annotations.Parameters;
import org.testng.annotations.Test;

import com.newdemo.framework.base.ScriptBase;

import atu.testng.reports.ATUReports;
import atu.testng.reports.utils.Utils;

public class DBTest_Prod_EVG extends ScriptBase {
	@Parameters({ "ParameterNValue", "env" })
	@Test(description = "Launching LATAM URL", priority = 1, enabled = true)
	public void IntructorArea() throws Exception {
		try {
			ATUReports.indexPageDescription = "Connect application automation - Create Assignments and Instructor Area scenarios";
			ATUReports.setAuthorInfo("Kumaran M", Utils.getCurrentTime(), "2.2");
			String strDescription = "Launch the URL in browser and verify the product and prices";
			ATUReports.currentRunDescription = strDescription;
			objHTMLFunctions.ReportPassFail(strDescription, "ModuleName", "ModuleName");
			delToolsInDB();

		} catch (Exception e) {
			objHTMLFunctions.reportPassFailToATU(e.getMessage(), "Exception", "MESSAGE");

		}

	}

	public void loginLATAMURL() throws Exception {

		connect().INTLLoginPage().launchINTLURL();
		connect().INTLLoginPage().waitForHomePage(20);

		connect().INTLLoginPage().clickSearchTextBox();
		connect().INTLLoginPage().typeTheTextInSearchBox();
		connect().INTLLoginPage().clickSearchButton();
		connect().INTLLoginPage().clickCookieCloseButton();

	}

	public void connectDB() throws Exception {
		connect().INTLDB().delToolsInDB();
	}

	public void delToolsInDB() throws Exception {

		String dbHost = "172.26.50.12";
		String dbUser = "magentofeed_product_prod";

		String dbPassword = "jjLTm1M9i1Ui";

		Class.forName("com.mysql.cj.jdbc.Driver");

		System.out.println("Going to establish connection with Database");
		Connection con = DriverManager.getConnection(
				"jdbc:mysql://afq-intl-pbg-ryerson-prod.cluster-cyd1gczom61q.us-east-1.rds.amazonaws.com:3306/magentofeed_product_prod",
				dbUser, dbPassword);
		Statement stmt = con.createStatement();

		System.out.println("Going to execute the Query");
		
	// US String slectQuery = "SELECT ISBN13,LIST_PRICE, HUB_COUNTRY_CODE, COUNTRY_CODE, TAX_AMOUNT, LIST_PRICE+TAX_AMOUNT, DATE_MODIFIED,DATE_ADDED FROM MAGENTO_PRODUCT_PRICE WHERE COUNTRY_CODE IN ('US') AND (DATE_MODIFIED>='2024-05-16' OR DATE_ADDED>='2024-05-16') AND CAN_SELL_FLAG='Y' ORDER BY COUNTRY_CODE LIMIT 200";

	// CA String slectQuery = "SELECT ISBN13,LIST_PRICE, HUB_COUNTRY_CODE, COUNTRY_CODE, TAX_AMOUNT, LIST_PRICE+TAX_AMOUNT, DATE_MODIFIED,DATE_ADDED FROM MAGENTO_PRODUCT_PRICE WHERE COUNTRY_CODE='CA' AND ISBN13 IN ('9780077862428','9780070109100','9780070165625','9780070159068','9780070285552','9780070285576','9780070998001','9780070998421','9780071013048','9780070278431','9780335247219','9780073199634','9780073401324','9780077862480','9780073524184','9780074715840','9780077129668','9780073523873','9780077114282','9780077109080','9780077122799','9780073513294','9780077158392','9780072524932','9780073376189','9780073384542','9780073384412','9780073534800','9780078038419','9780073532387','9780077107413','9780078035654','9780078024238','9781259131417','9780071016193','9780077140069','9780073513973','9780070998124','9780077095024','9780077098582','9781259299742','9781259330476','9780073511252','9781259290626','9780077377144','9780077776770','9780077776787','9780077843335','9781259166709','9781259158315','9781259315244','9781259225222','9781259677441','9781259677465','9781259677472','9781259574894','9781259621307','9781259848049','9781259391804','9781259951862','9781259277207','9781259877766','9780078028120','9780078028182','9781259538988','9781259696534','9781259865633','9780073385891','9780073404226','9780073529561','9781259277191','9781260084481','9781260085235','9781259919497','9781260092608','9781260289688','9781260289695','9781260289701','9781260287844','9781260084658','9781260185218','9781260288346','9781259977145','9781260085006','9781260289817','9781260290226','9781260391954','9781260392142','9781260084740','9781260130706','9781259534386','9781259731259','9781260289084','9781260047882','9781260084467','9781260084498','9781260287257','9781260092431','9781260092486','9781260084504','9781260084566','9781260084641','9781260164268','9781260164350','9781260048551','9781260092554','9781260092585','9781260200751','9781260231434','9781260136371','9781260136449','9781260164893','9781260165487','9781260141146','9781260092721','9781260092745','9781260092943','9781260098358','9781260131543','9781260440003','9781259892929','9781259191558','9781260048360','9781260049350','9781760420512','9781260242331','9781260091991','9781260000313','9781260092042','9781260092141','9781260105391','9781260076660','9781260084801','9781260085037','9781260085082','9781260085198','9781260267372','9781260267501','9781260570144','9781260084955','9781260154467','9781260410808','9781260430479','9781260085303','9781260085341','9781260399738','9781260403831','9781260407617','9781260565997','9781260566000','9781260566062','9781260395501','9781260397734','9781260290295','9781259282683','9781260547641','9781260290318','9781260547719','9781260565669','9781260568752','9781260568790','9781260565546','9781526847751','9781526847768','9781259601910','9781260547726','9781260547740','9781260547849','9781260289220','9781260289657','9781526847775','9781260053364','9781260548020','9781260548051','9781260548068','9781260565577','9781260548006','9781260565478','9781260565911','9781260566376','9781260053494','9781260197020','9781260547894','9781260687521','9780077449643','9781260569650','9781260575736','9781260575743','9781260575750','9781260566185','9781260566222','9781260566246','9781260566284','9781260566291','9781260486780','9781260486964','9781260571448','9781260571493','9781260575088','9781260575149','9781260575842','9781260575873','9781260575880','9781260566321','9781260566383','9781260566406','9781260566437','9781260575415','9781260575514','9781260575644','9781260576023','9781260566505','9780335262199','9781260095470','9781260575538','9781260686654','9781260575279','9781260575286','9781260571370','9781260571387','9781260571394','9781260571400','9781260571417','9781260571424','9781260571431','9781260590845','9781260423365','9781260569032','9781260687170','9781260153811','9781260165005','9781260570717','9781260575446','9781260575484','9781260575491','9781260575507','9781260575521','9781260575552','9781260575569','9781260575613','9781260575620','9781260566055','9781259951770','9781260547696','9781260569971','9781260569995','9781260570007','9781260570052','9781260391015','9781260570939','9781260398441','9781260566147','9781260570984','9781260571028','9781260571035','9781260571042','9781260571073','9781260571080','9781260571110','9781260571141','9781260568585','9781260568615','9781260568486','9781259693762','9781260570403','9781260570410','9781260570434','9781260570441','9781260571165','9781260571202','9781260571226','9781260571332','9781260571363','9781260569339','9781260570724','9781260570731','9781260570762','9781260570526','9781260570779','9781260570786','9781260248623','9781260570557','9781260570564','9781260570793','9781260570809','9781260570816','9781260570823','9781260570847','9781260570892','9781260570625','9781260570632','9781260570649','9781260570670','9781260570687','9781260570694','9781260569780','9781260569827','9781260569834','9781260569865','9781260569919','9781260569575','9781260569001','9781260589467','9781260589474','9781260589498','9781260589573','9781260589580','9781260589610','9781260834406','9781260834529','9781260839111','9781260590579','9781260590593','9781260590630','9781260590661','9781260590685','9781260590746','9781260289626','9781260289671','9781260569063','9781260589658','9781260589740','9781260579352','9781260579383','9781260579574','9781260579659','9781260569155','9781260589771','9781260589917','9781260579680','9781260579697','9781260542226','9781260707571','9781260289831','9781260570069','9781260805628','9781260807424','9781260808032','9781260808995','9781260289282','9781260289299','9781260289909','9781260290325','9780077637507','9781260590388','9781260579758','9781260569162','9781260569247','9781260569292','9781260569315','9781526847782','9781526847799','9781260590418','9781260590715','9781260570465','9781260590036','9781260579741','9781260579765','9781260579772','9781260579789','9781260569322','9781260569360','9781260569384','9781260590005','9781260590012','9781260590043','9781260590111','9781260590135','9781260590203','9781260590227','9781260590456','9781260568653','9781260568707','9781260290493','9781260569605','9781260569711','9781260569445','9781260565751','9781260570038','9781260570045','9781260437423','9781260541830','9781260569483','9781260569551','9781260590234','9781260590265','9781260590319','9781260590326','9781260590395','9781260590401','9781260590432','9781260489200','9781760424596','9781260569773','9781260590753','9781260288780','9781260288896','9781264394272','9781264177288','9781264177370','9781264177400','9781264177639','9781264177691','9781260575828','9781264177714','9781264185122','9781264209545','9781264364411','9781264886784','9781260526387','9781264726615','9781264796151','9781260590104','9781260711479','9781260711554','9781260719253','9781260719291','9781260733792','9781260786040','9781260786125','9781264868377','9781259914461','9781260571011','9781260575132','9781260590869','9781264265404','9781264266227','9781264270873','9781260359978','9781260397864','9781260425499','9781260430356','9781260478716','9781260483741','9781264250110','9781264250219','9781264250622','9781264262830','9781264263639','9781264263707','9781260443127','9781264911646','9781264912650','9781264713929','9781260444032','9781260446531','9781260471953','9781260539264','9781260701340','9781260885149','9781264088065','9781260579239','9781260786224','9781260788563','9781260790030','9781260791228','9781260792782','9781260808353','9781260808780','9781260862133','9781260868067','9781260871876','9781264002795','9781264357680','9781260506303','9781260521016','9781260579284','9781260579567','9781264003389','9781264364299','9781264071173','9781264071210','9781264071432','9781264071531','9781264071722','9781264072057','9781526848284','9781260242379','9781260359343','9781260393033','9781260424928','9781260442199','9781260443790','9781260579376','9781260590128','9781264928606','9781264009701','9781264029709','9781264033546','9781264049103','9781264058549','9781260445107','9781260446395','9781260288995','9781264069248','9781264069354','9781264071036','9781260589788','9781260579208','9781260579215','9781260579291','9781260579307','9781260466294','9781260477641','9781260484533','9781260575545','9781260487138','9781260488616','9781260497052','9781264968411','9781264969180','9781264360932','9781260579734','9781260590364','9781264363353','9781264363360','9781264363421','9781264363537','9781264363810','9781264364077','9781264363292','9781264155378','9781264115006','9781264121250','9781264771387','9781264371204','9781264164257','9781264169115','9781264169252','9781264169429','9781264169443','9781264169559','9781264169702','9781264169801','9781264169900','9781264170036','9781264240197','9781264170180','9781264440931','9781264568390','9781264646449','9781264527465','9781264710058','9781264711468','9781264713561','9781264790357','9781264562817','9781264734962','9781264363612','9781260579147','9781260393675','9781264370832','9781264363926','9781264364404','9781260431278','9781264072675','9781264072699','9781264072835','9781264072934','9781264073238','9781264108046','9781264111350','9781260575897','9781265799731','9781264364312','9781264364428','9781264364473','9781264748136','9781264360949','9781264766833','9781264131266','9781264131327','9781264138616','9781264140244','9781264357734','9781264804436','9781260570243','9781260597653','9781260597660','9781260597677','9781260597691','9781260597714','9781260597721','9781260597738','9781260597745','9781260597752','9781260597769','9781265176464','9781265177492','9781265215767','9781265242435','9781265316228','9781265324339','9781265335328','9781265348441','9781265359447','9781265450090','9781260290417','9781260571455','9781260805185','9781260805246','9781260807820','9781260808483','9781260813265','9781260813593','9781260813715','9781260834772','9781260835052','9781260838404','9781260838930','9781260936988','9781264053889','9781264284597','9781264337897','9781260598100','9781260598155','9781260598179','9781260598186','9781260598193','9781260598216','9781260598230','9781264363643','9781264363650','9781264364749','9781260597776','9781260597783','9781264088089','9781260591712','9781265741914','9781265818630','9781265824839','9781264433681','9781264439201','9781264440832','9781264462278','9781264483969','9781259668197','9781264695157','9781264004690','9781260079449','9781260079906','9781260589481','9781260590678','9781260597561','9781260597585','9781265561437','9781265577568','9781265588076','9781265636883','9781265648992','9781265653149','9781265669454','9781265714550','9781265741716','9781260579260','9781260579345','9781260579598','9781260590357','9781264731244','9781260597608','9781260597622','9781264370597','9781264417001','9781264479344','9781264500154','9781264510870','9781264539611','9781260579390','9781264363414','9781264554614','9781264589302','9781264647415','9781264704651','9780077956431','9780077957698','9780077959739','9781264364039','9781264388998','9781264511075','9781264593712','9781260473018','9781260575248','9781264040216','9781260590142','9781260493511','9781260511888','9781260672954','9781260675825','9781260818185','9781264045969','9781264058686','9781260818413','9781264892884','9781264972432','9781265017750','9781265028244','9781265042486','9781265062316','9781265071509','9781265082291','9781265107888','9781265160074','9781260472509','9781260706451','9781260708059','9781260412994','9781260414073','9781260426762','9781260736502','9781260782073','9781260804935','9781260443967','9781260445343','9781260818659','9781260818673','9781260818697','9781260597646','9781260807578','9781260575859','9781260598087','9781264363803','9781264370733','9781264370740','9781264370757','9781264370764','9781264370788','9781264370801','9781264371143','9781264371150','9781264363629','9781264363667','9781260589955','9781260589962','9781260597387','9781264453153','9781264727681','9781264729012','9781260590425','9781264393978','9781264425426','9781264767908','9781260589627','9781260589818','9781264371235','9781264400782','9781264422036','9781264423422','9781264426430','9781264428816','9781260590340','9781526848338','9781264798377','9781264478989','9781264494521','9781264494651','9781260333220','9781264371228','9781264371242','9781264371259','9781264486434','9781264511440','9781264516407','9781264554331','9781264561209','9781264562329','9781264588015','9781264393213','9781264404049','9781264406326','9781264873265','9781264411443','9781264363551','9781264363827','9781264364091','9781264459179','9781264464739','9781264475032','9781266071010','9781266107931','9781266244940','9781264364732','9781264357635','9781264357659','9781264671922','9781264673544','9781264363452','9781264363704','9781264363780','9781264363957','9781264364008','9781264364022','9781264415861','9781259272011','9781259654770','9781260597806','9781260597813','9781260597820','9781264442652','9781264445004','9781264446919','9781260597684','9781264694235','9781260065800','9781260065817','9781264370726','9781264370771','9781260597868','9781260597899','9781260597912','9781260597929','9781260597936','9781260597943','9781260597950','9781260598018','9781260598025','9781264708284','9781264364343','9781264364497','9781260575200','9781260326864','9781260352566','9781526848314','9781264578146','9781259406775','9781264370870','9781264370887','9781264670932','9781265129552','9781265755010','9781265924706','9781264999088','9781265000967','9781264370979','9781264627158','9781264627912','9781264628865','9781264654543','9781264654727','9781260598070','9781264593613','9781264593644','9781264595228','9781264614943','9781264636464','9781264978724','9781264981328','9781264371112','9781264371129','9781264658732','9781264354719','9781264386659','9781265898472','9781265905729','9781265917050','9781265953591','9781264575435','9781266070945','9781260577112','9781260577129','9781260597905','9781264370634','9781265175535','9781260575118','9781264370665','9781264370672','9781264370689','9781260597998','9781260598001','9781265639778','9781265815578','9781264568666','9781264514380','9781264519668','9781264522514','9781264526673','9781264529483','9781264530410','9781264578238','9781259088483','9781260065893','9781260311143','9781260326475','9781260326482','9781260326826','9781260820935','9781260575170','9781260575187','9781260597462','9781260579369','9781264370719','9781264090808','9781264370825','9781264596096','9781264615438','9781264536177','9781260598117','9781260598131','9781265064372','9781265833237','9781264616435','9781264624546','9781264559930','9781260590258','9781265222642','9781264364329','9781264648023','9781264672738','9781264490646','9781264491957','9781264511020','9781264538805','9781264559237','9781264561803','9781264265442','9781264357642','9781264357673','9781264357727','9781264360895','9781264363261','9781264363308','9781264363322','9781264363407','9781264363544','9781264363636','9781264363735','9781264363742','9781264553587','9781264677443','9781264679065','9781264680504','9781264360925','9781260598094','9781260571219','9781260571318','9781264363223','9781260570908','9781264363933','9781264363940','9781264363995','9781264364053','9781264364060','9781264364138','9781264364183','9781264364190','9781260705669','9781260705683','9781264160365','9781264341979','9781264349838','9781265093587','9781264363674','9781264364220','9781264364237','9781264364244','9781264364268','9781264364305','9781264364398','9781264364435','9781264364466','9781265286330','9781266138195','9781260470499','9781264625963','9781264564743','9781264582662','9781264364541','9781264364596','9781264177554','9781260397628','9781260598209','9781265748593','9781264364602','9781264364626','9781264364664','9781264364671','9781264364718','9781264364725','9781264887712','9781264418756','9781264422685','9781264531219','9781264160341','9781264160372','9781264160389','9781260597707','9781265598716','9781264342211','9781264605590','9781264650088','9781264991051','9781264360956','9781264363575','9781260579130','9781260590067','9781760425647','9781260597615','9781265105303','9781265992446','9781264363582','9781259731693','9781264435319','9781264827664','9781264923083','9781265265892','9781264111237','9781526848758','9781265290795','9781264360703','9781264972043','9781264978557','9781264364114','9781264363605','9781264363896','9781265359539','9781259997709','9781264990979','9781264108671','9781264110605','9781264357666','9781264987030','9781264987764','9781265798192','9781264363759','9781264461622','9781265003937','9781260597851','9781264993178','9781264993482','9781264995158','9781264986941','9781264988358','9781264988747','9781264994328','9781264357710','9781266240102','9781266505317','9781266506789','9781266029646','9781264339600','9781266668838','9781266669422','9781266673191','9781266675669','9781266676307','9781266677250','9781266677724','9781266296284','9781266568046','9781264851577','9781266773150','9781266773358','9781266773495','9781266774010','9781266774102','9781266783364','9781266683985','9781266685033','9781266685323','9781266687860','9781266695933','9781264868575','9781264869671','9781264874521','9781264876204','9781260867022','9781264494576','9781264799787','9781265735685','9781266747328','9781266696138','9781266696374','9781266699740','9781266700040','9781266700163','9781266701320','9781266704307','9781266708992','9781266709463','9781266709500','9781266713118','9781266713286','9781266714207','9781266716492','9781266716751','9781266719776','9781266720444','9781266722110','9781266312502','9781266318429','9781266319013','9781266730962','9781266731402','9781266765377','9781266791512','9781266793356','9781266823909','9781266336317','9781266371264','9781266378485','9781266386268','9781266463204','9781266463402','9781266484612','9781266552281','9781266578816','9781266579363','9781266596247','9781266600098','9781266824968','9781266826283','9781266826788','9781266828522','9781266829185','9781266653124','9781266661020','9781266663789','9781266722387','9781266724992','9781266832079','9781266832765','9781266833571','9781266834752','9781266849985','9781266774072','9781266302565','9781266305641','9781266305825','9781266305887','9781266313240','9781265561994','9781265562953','9781265573607','9781265598525','9781265605353','9781265608132','9781265647674','9781265666057','9781265683986','9781266851131','9781266852176','9781266853531','9781266854781','9781266319723','9781266323706','9781266331725','9781266336959','9781266341816','9781266342028','9781266347610','9781266349386','9781266360947','9781265708429','9781265723804','9781265732646','9781265737986','9781265765637','9781265767662','9781265770495','9781265773649','9781266369377','9781266378164','9781266378911','9781266382567','9781266389436','9781266390876','9781266393563','9781266436147','9781266442216','9781266476020','9781266481482','9781266481697','9781266483530','9781266488269','9781266489945','9781266301698','9781266321375','9781266576799','9781266599361','9781266301308','9781266574993','9781260994049','9781260994056','9781266490323','9781266490569','9781266492426','9781266497919','9781266369049','9781265009502','9781264849710','9781265513467','9781266649295','9781266774270','9781265744793','9781265287269','9781265489397','9781260387056','9781260994650','9781264136476','9781264243655','9781265910518','9781265046798','9781265248123','9781265622978','9781265680572','9781265813024','9781265983338','9781264988051','9781264170104','9781265246600','9781264877584','9781265074159','9781260794205','9781260258981','9781264137275','9781265145279','9781260577105','9781265840785','9781264110698','9781264120734','9781265026172','9781265078379','9781265091958','9781265098612','9781265139575','9781265230036','9781265236311','9781265249243','9781265262372','9781265266707','9781265867294','9781265874957','9781265882464','9781265891176','9781265899653','9781265914592','9781265925598','9781265926359','9781265999001','9781266008566','9781266041846','9781266042539','9781260597530','9781266069512','9781266074165','9781266075490','9781266076442','9781266077098','9781266080043','9781266083259','9781266083488','9781266084089','9781266085857','9781266085895','9781266089169','9781264121182','9781265286484','9781265287528','9781264363339','9781264363841','9781264363858','9781265287054','9781266089626','9781266091797','9781266092480','9781266095528','9781266097904','9781266098475','9781266100437','9781265316143','9781265330484','9781265336738','9781265444921','9781265464981','9781265475819','9781265490003','9781266110214','9781266110382','9781266113598','9781266113710','9781266114762','9781266115837','9781266118678','9781266120909','9781266122170','9781265515003','9781266151446','9781265539337','9781265556488','9781265563387','9781265632274','9781265634292','9781265646455','9781265655129','9781265678111','9781265687113','9781265698041','9781265004552','9781265004828','9781265005573','9781265274597','9781266294150','9781265501211','9781265709037','9781265727550','9781265766757','9781265773519','9781265787660','9781265804466','9781265806040','9781265816674','9781265826765','9781265829636','9781265837860','9781265277338','9781265279172','9781265280192','9781265296735','9781265302962','9781265304430','9781265309282','9781265309718','9781265310776','9781265313302','9781265316723','9781265316785','9781264737901','9781264739585','9781266135095','9781266138607','9781266142321','9781265368180','9781265390471','9781265743116','9781265317669','9781265318338','9781265322960','9781265325824','9781265327170','9781265337322','9781265342715','9781265344665','9781265344795','9781265351472','9781266142901','9781265354060','9781265356910','9781265357078','9781265358815','9781265359669','9781265361624','9781265361860','9781265362966','9781265366315','9781265367930','9781265375560','9781265496067','9781265383947','9781265384838','9781265388904','9781265389758','9781265393373','9781265395025','9781265395193','9781265396794','9781265402471','9781265403782','9781265415334','9781265415426','9780077507749','9781260465211','9781260564143','9781266772863','9781266774928','9781266775062','9781266775314','9781266777233','9781265419547','9781265420963','9781265426613','9781265429430','9781265430078','9781265434236','9781265441999','9781265442521','9781265442576','9781265447588','9781265450441','9781265451097','9781260719369','9781264113071','9781264560165','9781266777325','9781266777738','9781265451653','9781265455798','9781265459987','9781265460136','9781265460570','9781265460884','9781265464738','9781265467692','9781265481858','9781265482701','9781265490751','9781265492090','9781265492823','9781266779435','9781266779725','9781266780769','9781266783593','9781265149048','9781265149420','9781265494728','9781265505103','9781265508616','9781265508753','9781265512835','9781265513085','9781265513177','9781265516956','9781265518080','9781265518905','9781265520571','9781265523657','9781265166588','9781265166649','9781265169688','9781265531737','9781265539023','9781265542313','9781265543181','9781265548780','9781266338885','9781266341540','9781266131752','9781266132148','9781266132261','9781266133909','9781266134791','9781266134951','9781266135828','9781266136221','9781266136788','9781266137075','9781265167691','9781266558085','9781266559495','9781266561047','9781266564604','9781266568053','9781266569159','9781266570087','9781266570193','9781266571060','9781265688394','9781266344923','9781266349911','9781266355318','9781266358661','9781266358869','9781266359798','9781266370267','9781266373374','9781266377976','9781266379994','9781266572890','9781266573040','9781266576522','9781266577185','9781266577680','9781266578984','9781266579073','9781266580703','9781266582134','9781266584053','9781264112586','9781266384240','9781266389108','9781266389733','9781266392030','9781266393044','9781266406294','9781266414480','9781266420412','9781266420641','9781266422751','9781264339587','9781265174408','9781265174811','9781265621544','9781265822064','9781266586163','9781266586255','9781266590108','9781266595486','9781266598678','9781265631529','9781266429514','9781266430367','9781266432958','9781266436765','9781266440335','9781266443565','9781266445804','9781266138225','9781266141515','9781266143090','9781266624254','9781266626487','9781266629006','9781266629990','9781266630248','9781266631207','9781266631252','9781266632242','9781266635823','9781265647155','9781265851408','9781266447181','9781266448454','9781266452277','9781266456381','9781266458026','9781266463082','9781266472381','9781266473944','9781266144271','9781266145315','9781266149023','9781266150814','9781266151637','9781266152115','9781266152955','9781266153617','9781266156649','9781266637162','9781266640131','9781266650444','9781266650604','9781266658310','9781266666773','9781265009403','9781265124564','9781265007638','9781266159244','9781266159503','9781266166938','9781266170829','9781266177330','9781266181054','9781266187308','9781266599545','9781266600401','9781266602825','9781266607271','9781266609183','9781266611537','9781266612190','9781266612817','9781266622038','9781266474712','9781266475818','9781266477720','9781266479328','9781266189142','9781266189401','9781266191862','9781266195839','9781266196591','9781266197048','9781266198120','9781266198267','9781266200465','9781266203367','9781266203893','9781266210068','9781266211393','9781266212789','9781266217654','9781266219252','9781266220050','9781266222016','9781266222832','9781266223013','9781266223938','9781266224058','9781266224584','9781266224652','9781264364107','9781264364176','9781265017965','9781266481055','9781266483516','9781266486647','9781266486685','9781266489174','9781266491139','9781266492150','9781266493355','9781266495540','9781266496578','9781266226373','9781266227110','9781266229770','9781266230950','9781266233890','9781266235047','9781266236372','9781266238970','9781266240850','9781266249747','9781266254727','9781266501890','9781266502620','9781266513176','9781266514838','9781266517945','9781266522239','9781266255267','9781266256141','9781266261077','9781266261503','9781266262494','9781266263293','9781266264139','9781266522765','9781266522932','9781266525513','9781266526671','9781266271007','9781266271113','9781266271762','9781266273131','9781266273940','9781266275111','9781266275326','9781266275722','9781266276750','9781266277474','9781266278518','9781266528125','9781266530852','9781266531927','9781266533518','9781266535321','9781266536144','9781266537448','9781266538322','9781266281624','9781266283154','9781266283536','9781266284960','9781266287022','9781266287152','9781266287589','9781266288975','9781266289538','9781266290046','9781266128493','9781266129315','9781266129513','9781266539718','9781266543166','9781266547577','9781266548000','9781266295850','9781266296031','9781266297274','9781266298332','9781266300080','9781266302473','9781266303968','9781266308383','9781266310003','9781266312557','9781266313844','9781266550768','9781266551239','9781266552762','9781266554490','9781266554612','9781266556876','9781264364589','9781260376494','9781264169214','9781266317958','9781266321054','9781266321429','9781266327711','9781266329876','9781266333385','9781265830175','9781265841522','9781265841577','9781265845803','9781265846671','9781265850456','9781265850579','9781265852177','9781265860530','9781265862466','9781265863234','9781265865788','9781265929244','9781265929602','9781265934231','9781265935429','9781265937683','9781265945657','9781265947071','9781265948269','9781265950026','9781265954437','9781265957599','9781265957889','9781260719277','9781260540154','9781265958114','9781265958664','9781265958824','9781265959777','9781265961305','9781265962036','9781265962098','9781265965495','9781265965846','9781265966805','9781265967000','9781265967406','9781260447965','9781264253494','9781265969530','9781265969837','9781265972141','9781265973537','9781265974060','9781265976019','9781265977290','9781265978648','9781265980184','9781265980924','9781265983130','9781265989200','9781265991548','9781265993252','9781265994600','9781265995959','9781265996239','9781266001291','9781266001796','9781266002748','9781266004070','9781266008658','9781266014901','9781266069017','9781265247188','9781264794232','9781264799077','9781264819942','9781265246709','9781265019204','9781265020712','9781265023782','9781265044688','9781264822652','9781264823093','9781264824595','9781264828159','9781260597974','9781265341060','9781265341961','9781265343521','9781265344962','9781265345020','9781265348717','9781265637262','9781266182617','9781266744266','9781266752230','9781266752292','9781266752872','9781265433420','9781266753879','9781264445769','9781260525090','9781264248230','9781264248278','9781264248674','9781266581182','9781264773695','9781264774555','9781264775439','9781264776757','9781264778980','9781264781003','9781264781089','9781264781287','9781264782598','9781264783038','9781264786374','9781264787012','9781264789900','9781264792443','9781265778057','9781265780999','9781265781743','9781265781767','9781265788544','9781265789657','9781265790448','9781265362737','9781266183133','9781266259272','9781266512612','9781266551932','9781266670114','9781265493837','9781265867744','9781265868826','9781265870027','9781265877583','9781265879181','9781265879419','9781265881726','9781265892647','9781265894597','9781265894986','9781265897048','9781265904548','9781265790615','9781265791643','9781265798673','9781265800093','9781265800482','9781265801694','9781265802363','9781265802455','9781265803087','9781265804015','9781265806606','9781265807573','9781265811815','9781265904999','9781265909246','9781265910846','9781265913014','9781265915926','9781265918286','9781265918958','9781265919764','9781265922504','9781265922559','9781265926151','9781265927578','9781265813291','9781265816391','9781265817336','9781265821913','9781265822385','9781265822446','9781265822538','9781265823726','9781265825072','9781265828349','9781265828448','9781265829117','9781265050412','9781265051082','9781265299828','9781265300159','9781265301194','9781265302689','9781265306878','9781264369294','9781264377695','9781264382224','9781264383863','9781264387809','9781264393916','9781264405978','9781264406937','9781264406944','9781266034398','9781266051500','9781266076657','9781266108334','9781266170621','9781266175886','9781266494031','9781260881370','9781260881387','9781260881400','9781264407507','9781264407545','9781264407781','9781264408801','9781264421008','9781264421114','9781264421572','9781264433933','9781264445356','9781264446759','9781265226596','9781265231248','9781265233556','9781265237189','9781265237769','9781265239428','9781265240516','9781265240714','9781265245481','9781265246136','9781265250065','9781264450411','9781264450923','9781264456130','9781264461257','9781264464791','9781264474134','9781264503636','9781265256340','9781265256531','9781265258085','9781265258672','9781265260156','9781265262105','9781265262198','9781265263218','9781265264697','9781265265878','9781265282035','9781265379414','9781264360901','9781264561070','9781264567874','9781265424909','9781265430184','9781265430627','9781265485047','9781265560089','9781265564841','9781265566111','9781265569105','9781265569884','9781266534379','9781266566486','9781266568039','9781266589164','9781266592003','9781266654664','9781266711381','9781264583164','9781264598359','9781264607525','9781264775668','9781264776771','9781264864584','9781264866045','9781264898077','9781265575656','9781265578985','9781265580131','9781265580384','9781265586140','9781265587901','9781265588021','9781265588298','9781265588601','9781265588700','9781265590000','9781266058301','9781264933860','9781264939541','9781264950805','9781264960880','9781264960989','9781264967544','9781264972883','9781265591991','9781265599652','9781265602048','9781265602079','9781265602192','9781265604561','9781265610470','9781265610678','9781265611934','9781265614775','9781264980659','9781264997916','9781265000448','9781265006440','9781265033811','9781265037536','9781265038540','9781265042639','9781265045630','9781265615697','9781265616786','9781265617660','9781265617974','9781265619466','9781265621018','9781265624767','9781265625870','9781265625986','9781265626983','9781265045845','9781265051303','9781265051563','9781265056704','9781265059613','9781265628048','9781265628338','9781265630485','9781265632762','9781265633479','9781265635572','9781265645151','9781265647575','9781265648626','9781265651947','9781265652463','9781265079833','9781265064013','9781265070403','9781265073350','9781265075538','9781265075804','9781265076825','9781265079246','9781265653842','9781265654030','9781265657659','9781265658847','9781265660246','9781265664541','9781265967185','9781265087685','9781265092252','9781265094454','9781265094492','9781265103712','9781265629427','9781265917128','9781265117702','9781265118068','9781265118433','9781265120085','9781265121136','9781265122447','9781265123031','9781265125554','9781265125998','9781265127718','9781265128845','9781265129583','9781265131449','9781265242992','9781265204549','9781265205478','9781265236748','9781264453030','9781265131814','9781265133351','9781265135744','9781265136734','9781265138462','9781265139193','9781265140557','9781265140601','9781265144470','9781265148225','9781265150495','9781265151201','9781265666835','9781265669775','9781265671617','9781265674557','9781265675479','9781265678692','9781265680275','9781265682620','9781265683870','9781265689360','9781264531455','9781265013776','9781265033033','9781265051891','9781265259235','9781265920302','9781265177959','9781265179380','9781265180454','9781265183134','9781265183608','9781265184513','9781265184810','9781265701031','9781265702519','9781265702571','9781265705688','9781265708863','9781265714215','9781265714666','9781265715496','9781265716028','9781266023026','9781266024917','9781266025471','9781266028267','9781266035586','9781266036033','9781264364282','9781265185954','9781265186241','9781265187712','9781265188153','9781265188573','9781265192075','9781265194062','9781265197285','9781265199197','9781265204600','9781265204754','9781265209247','9781265727352','9781265728007','9781265729363','9781265732295','9781265735104','9781265735357','9781265736064','9781265736194','9781265740757','9781264364206','9781265212636','9781265213367','9781265218485','9781265218836','9781265219444','9781265219499','9781265219697','9781265224295','9781265225209','9781265225285','9781265225513','9781265226060','9781265226565','9781265742287','9781265743888','9781265746247','9781265747640','9781265749835','9781265750602','9781265750640','9781265751883','9781265754334','9781265756598','9781259661044','9781260265200','9781260449198','9781264058945','9781264071685','9781264111138','9781264111312','9781264112043','9781264113156','9781265758356','9781265760304','9781265760397','9781265761639','9781265763688','9781265763848','9781265796693','9781265808129','9781265910020','9781266017087','9781265040055','9781265645984','9781264161546','9781264163106','9781264247875','9781264360185','9781264360321','9781264360536','9781264364367','9781264364688','9781266817441','9781266820335','9781266838613','9781266878275','9781266884290','9781264805259','9781264655809','9781266802508','9781264793143','9781266019548','9781266363245','9781266641756','9781266904646','9781264336906','9781266337017','9781266450006','9781266601088','9781266717512','9781266233975','9781266312533','9781266578908','9781266725418','9781264854493','9781264855872','9781264891634','9781265342579','9781265956240','9781266011658','9781266012969','9781266013638','9781266013898','9781266270123','9781266544941','9781265496401','9781265340049','9781265343194','9781266375569','9781266379956','9781266507762','9781266560477','9781266662201','9781266758850','9781266760808','9780072829860','9781266246678','9781266283192','9781264110803','9781265772703','9781264498949','9781264553228','9781264832125','9781264833252','9781264834709','9781264836147','9781264839278','9781264840212','9781264840311','9781264840397','9781264820832','9781264933877','9781264959051','9781266106729','9781266114908','9781266368998','9781266822865','9781264841882','9781264845378','9781264846306','9781264847358','9781264850747','9781264853526','9781260891065','9781266135170','9781266188350','9781266574344','9781266092015','9781266574160','9781266332104','9781266495403','9781266570148','9781266593048','9781266760044','9781266869013','9781264840014','9781260700404','9781265469870','9780072405927','9780072504477') LIMIT 200";
		//String slectQuery = "SELECT ISBN10, MASTER_EVG,HUB_COUNTRY_CODE,EVG_RELEASE_DATE,FORMAT,EVG_IC_FLAG FROM MAGENTO_PRODUCT_REGION WHERE MASTER_EVG IS  not NULL AND HUB_COUNTRY_CODE='GB' AND ATTRIBUTE2='Y' AND EVG_IC_FLAG= 'Y' order by MASTER_EVG DESC";
		String slectQuery = "SELECT ISBN10, MASTER_EVG,HUB_COUNTRY_CODE,EVG_RELEASE_DATE,FORMAT,EVG_IC_FLAG FROM MAGENTO_PRODUCT_REGION WHERE HUB_COUNTRY_CODE='GB' AND ISBN10 IN ('1265322368','1264364490','1265000964','1265841578','1264363907','1265267456','1265554536','1264363826','1265459983','1260590909','126552260X')";
		//String slectQuery="SELECT ISBN13,LIST_PRICE, HUB_COUNTRY_CODE, COUNTRY_CODE, TAX_AMOUNT, LIST_PRICE+TAX_AMOUNT, DATE_MODIFIED,DATE_ADDED FROM MAGENTO_PRODUCT_PRICE WHERE COUNTRY_CODE IN ('MX') AND (DATE_MODIFIED='2024-06-02' OR DATE_ADDED='2024-06-02') AND CAN_SELL_FLAG='Y' ORDER BY COUNTRY_CODE";
		//String slectQuery = "SELECT ISBN13,LIST_PRICE, HUB_COUNTRY_CODE, COUNTRY_CODE, TAX_AMOUNT, LIST_PRICE+TAX_AMOUNT, DATE_MODIFIED,DATE_ADDED FROM MAGENTO_PRODUCT_PRICE WHERE ISBN13 IN (SELECT ISBN13 from MAGENTO_PRODUCT where OWNING_DIVISION_CODE in ('30', '06','55')) and COUNTRY_CODE='CA' and CAN_SELL_FLAG='Y' LIMIT 200 OFFSET 2000";
		//String slectQuery = "select ISBN13,LIST_PRICE, HUB_COUNTRY_CODE, COUNTRY_CODE, TAX_AMOUNT, LIST_PRICE+TAX_AMOUNT, DATE_MODIFIED,DATE_ADDED FROM MAGENTO_PRODUCT_PRICE from MAGENTO_PRODUCT_PRICE WHERE COUNTRY_CODE='CA' AND CAN_SELL_FLAG='Y'";
		System.out.println("The query going to be executed is : " + slectQuery);

		System.out.println("Preparing Result Set");
		ResultSet dbResult = stmt.executeQuery(slectQuery);

		System.out.println("---- Results ----");

		first: while (dbResult.next()) {
			waiting(2);
			String isbn10 = dbResult.getString("ISBN10");
			String countryCode = dbResult.getString("HUB_COUNTRY_CODE");
			String masterEVG = dbResult.getString("MASTER_EVG");
			String EVGReleaseDate = dbResult.getString("EVG_RELEASE_DATE");
			System.out.println(isbn10);
			System.out.println(countryCode);
			System.out.println(masterEVG);
			System.out.println(EVGReleaseDate);
			/*
			 * System.out.println(priceList + taxAmount); final DecimalFormat df = new
			 * DecimalFormat("0.00"); double input = priceList + taxAmount;
			 * System.out.println(df.format(input));
			 */
			
			
			
			
			
			
			
			
			
			  if (countryCode.equals("ME")) {
			  
			  strDTParametersNValues = "InputDataRow=>59"; final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("ES")) { strDTParametersNValues = "InputDataRow=>33";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("SG")) { strDTParametersNValues = "InputDataRow=>27";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("MX")) { strDTParametersNValues = "InputDataRow=>4";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("GB")) { strDTParametersNValues = "InputDataRow=>22";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("US")) { strDTParametersNValues = "InputDataRow=>26";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("AU")) { strDTParametersNValues = "InputDataRow=>29";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("CA")) { strDTParametersNValues = "InputDataRow=>24";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("CO")) { strDTParametersNValues = "InputDataRow=>31";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("IT")) { strDTParametersNValues = "InputDataRow=>36";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); } else if
			  (countryCode.equals("IN")) { strDTParametersNValues = "InputDataRow=>35";
			  final int defaultDataRow =
			  Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			  connect().INTLLoginPage().launchINTLURL(); }
			  
			     
			
			
			
			
			
			
			
			
			
			/*
			 * if (countryCode.equals("ME")) {
			 * 
			 * strDTParametersNValues = "InputDataRow=>60"; final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("ES")) { strDTParametersNValues = "InputDataRow=>11";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("SG")) { strDTParametersNValues = "InputDataRow=>15";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("MX")) { strDTParametersNValues = "InputDataRow=>2";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("GB")) { strDTParametersNValues = "InputDataRow=>6";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("US")) { strDTParametersNValues = "InputDataRow=>10";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("AU")) { strDTParametersNValues = "InputDataRow=>13";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("CA")) { strDTParametersNValues = "InputDataRow=>8";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("CO")) { strDTParametersNValues = "InputDataRow=>17";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("IT")) { strDTParametersNValues = "InputDataRow=>20";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); } else if
			 * (countryCode.equals("IN")) { strDTParametersNValues = "InputDataRow=>21";
			 * final int defaultDataRow =
			 * Integer.parseInt(strDTParametersNValues.split("=>")[1]);
			 * connect().INTLLoginPage().launchINTLURL(); }
			 */ 
			  			 			Thread.sleep(10000);
			connect().INTLLoginPage().clickAcceptAllButton();
			Thread.sleep(2500);
			connect().INTLLoginPage().clickSearchTextBox();
			connect().INTLLoginPage().getValue(isbn10);

			connect().INTLLoginPage().clickSearchButton();
			connect().INTLLoginPage().clickAcceptAllButton();

			connect().INTLLoginPage().clickCookieCloseButton();
			
			
			/*
			 * if ((connect().INTLLoginPage().validateProductIsbn13()) == true)
			 * 
			 * connect().INTLLoginPage().isbnDisplayed(); else {
			 * 
			 * continue first;
			 * 
			 * }
			 */	
			
			connect().INTLLoginPage().clickSecondLink();
			Thread.sleep(1000);
			connect().INTLLoginPage().clickAcceptAllButton();
			System.out.println(connect().INTLLoginPage().validateProductIsbn10());


			if ((connect().INTLLoginPage().validateProductIsbn10().equals(masterEVG)))

				connect().INTLLoginPage().masterEVGIsbnDisplayed();
			else {
				connect().INTLLoginPage().masterEVGIsbnNotDisplayed();

			}
			
			String rd=connect().INTLLoginPage().validateReleaseDate();
			System.out.println(rd);
			System.out.println(rd.substring(14));
			String releaseDate="";
			if(rd.contains("Release"))
			{
				releaseDate=rd.substring(14);
		        boolean datesAreEqual = connect().INTLLoginPage().compareDates(releaseDate, EVGReleaseDate);

		        // Print the result
		        if (datesAreEqual) {
		            System.out.println("Dates are equal");
		        } else {
		            System.out.println("Dates are not equal");
		        }
			}
			else {
				System.out.println("PUblised date");
			}

	        String url= driver.getCurrentUrl();
	        connect().INTLLoginPage().getValue(url);



			/*Thread.sleep(2500);
			if (countryCode.equals("ES") || countryCode.equals("IT")) {
				List<Integer> price_App = connect().INTLLoginPage().validatePriceListES();
				if (price_App.size() == 0) {
					connect().INTLLoginPage().priceNotFound();
					continue first;
				}
				if (taxAmount == 0) {
					float price_DB = connect().INTLLoginPage().getFloatValue(priceList);
					String dbPrice = Float.toString(price_DB).replaceAll("[^0-9]", "");
					if (price_App.contains(dbPrice))
						connect().INTLLoginPage().correctPrice();
					else
						connect().INTLLoginPage().incorrectPrice();
				} else {
					String price_DB = connect().INTLLoginPage().getFloatDecValue(df.format(input)).replaceAll("[^0-9]",
							"");

					int dbPrice = Integer.parseInt(price_DB);
					if (price_App.contains(dbPrice))
						connect().INTLLoginPage().correctPrice();
					else
						connect().INTLLoginPage().incorrectPrice();
				}
			} else {
				List<Float> price_App = connect().INTLLoginPage().validatePriceList();
				if (price_App.size() == 0) {
					connect().INTLLoginPage().priceNotFound();
					continue first;
				}
				if (taxAmount == 0) {
					float price_DB = connect().INTLLoginPage().getFloatValue(priceList);
					if (price_App.contains(price_DB))
						connect().INTLLoginPage().correctPrice();
					else
						connect().INTLLoginPage().incorrectPrice();
				} else {
					String price_DB = connect().INTLLoginPage().getFloatDecValue(df.format(input));
					float dbPrice = Float.parseFloat(price_DB);
					if (price_App.contains(dbPrice))
						connect().INTLLoginPage().correctPrice();
					else
						connect().INTLLoginPage().incorrectPrice();
				}

			}*/

		}

		System.out.println("Going to close the Connection with database");
		con.close();
	}

}